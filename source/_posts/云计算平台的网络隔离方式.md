---
title: 云计算平台的网络隔离方式
date: 2021-06-23 16:06:24
tags:
---

## 基本概念

## VPC （Virtual Private Cloud）- 私有网络 

私有网络（Virtual Private Cloud，VPC）是一块您在腾讯云上自定义的逻辑隔离网络空间，您可以为 云服务器、云数据库 等资源构建逻辑隔离的、用户自定义配置的网络空间，以提升用户云上资源的安全性，并满足不同的应用场景需求。

### EIP（Elastic IP Address） - 弹性公网IP

弹性公网IP（Elastic IP Address，简称EIP）是可以独立购买和持有的公网IP地址资源，可绑定到专有网络VPC内的ECS实例、私网SLB实例和NAT网关上。弹性公网EIP突破传统的束缚，实现IP与服务实例分离，基于松耦合的方式，可以动态解绑和绑定，从而提高网络的灵活性。
弹性公网EIP工作原理：EIP实则是一种NAT IP，位于阿里云公网网关上，通过NAT映射的方式绑定到VPC网络的ECS/SLB/NAT等实例的私网网卡上，因此，绑定EIP的ECS/SLB/NAT实例可以直接使用该IP进行公网通信，但是在ECS实例的网卡上并不能看到该IP地址。

### CLB（Cloud Load Balancer，CLB）- 负载均衡

负载均衡（Cloud Load Balancer，CLB），提供：安全快捷的流量分发服务，访问流量经由 CLB 可以自动分配到云中的多台云服务器上，扩展系统的服务能力并消除单点故障。

访问控制列表的英文为Access Control List，简称ACL，是物联网中保障系统安全的一种技术。小编在这里整理了一些关于ACL的知识与大家分享一下，有需要的也可以收藏起来哦。

### ACL（Access Control List）- 访问控制列表

　　ACL是在实际网络环境中经常用到的安全控制技术， 是路由器和交换机接口的指令列表，用来控制端口进出的数据包。

　　实际上，ACL的本质就是用于描述一个IP数据包、以太网数据帧若干特征的集合。然后根据这些集合去匹配网络中的流量(由大量数据包组成)，同时根据策略来“允许”或者“禁止”。

　　ACL的基本原理

　　1、ACL由若干条件，并按照一定的顺序而成，同时每个条件都对应了一个策略：允许或者禁止。

　　2、收到一个数据帧之后，ACL会按照从上到下的顺序逐一匹配：

　　1)一个条件不匹配就查看下一个;

　　2)任意一个条件匹配后就按照指定的策略执行，并跳出匹配;

　　3)所有条件都不匹配时，默认禁止，即deny。

　　ACL的功能

　　1.限制网络流量、提高网络性能。例如，ACL可以根据数据包的协议，指定这种类型的数据包具有更高的优先级，同等情况下可预先被网络设备处理。

　　2.提供对通信流量的控制手段。

　　3.提供网络访问的基本安全手段。

　　4.在网络设备接口处，决定哪种类型的通信流量被转发、哪种类型的通信流量被阻塞。

### Security Group - 安全组

安全组是一种虚拟防火墙，具备有状态的数据包过滤功能，用于设置云服务器、负载均衡、云数据库等实例的网络访问控制，控制实例级别的出入流量，是重要的网络安全隔离手段。
您可以通过配置安全组规则，允许或禁止安全组内的实例的出流量和入流量。

安全组特点

安全组是一个逻辑上的分组，您可以将同一地域内具有相同网络安全隔离需求的云服务器、弹性网卡、云数据库等实例加到同一个安全组内。
关联了同一安全组的实例间默认不会互通，您需要添加相应的允许规则。
安全组是有状态的，对于您已允许的入站流量，都将自动允许其流出，反之亦然。
您可以随时修改安全组的规则，新规则立即生效。
使用限制

有关安全组的使用限制及配额，请参见 使用限制总览 中的安全组相关限制章节。

安全组规则

组成部分
安全组规则包括如下组成部分：

来源：源数据（入站）或目标数据（出站）的 IP。
协议类型和协议端口：协议类型如 TCP、UDP 等。
策略：允许或拒绝。
规则优先级
安全组内规则具有优先级。规则优先级通过规则在列表中的位置来表示，列表顶端规则优先级最高，最先应用；列表底端规则优先级最低。
若有规则冲突，则默认应用位置更前的规则。
当有流量入/出绑定某安全组的实例时，将从安全组规则列表顶端的规则开始逐条匹配至最后一条。如果匹配某一条规则成功，允许通过，则不再匹配该规则之后的规则。

## 对比分析

### 安全组 & ACL


| 对比项 | 安全组 | 网络ACL |
|:---:|:---:|:---:|
|流量控制|云服务器、数据库等实例级别的流量访问控制|子网级别的流量控制|
|规则|支持允许规则、拒绝规则|支持允许规则、拒绝规则|
|有无状态|有状态：返回数据流会被自动允许，不受任何规则的影响|无状态：返回数据流必须被规则明确允许|
|生效时间|只有在创建云服务器、云数据库等实例时指定安全组，或实例创建后再关联安全组，规则才会被应用到实例|创建 ACL 并绑定子网后，ACL 将自动应用到关联子网内的所有云服务器、云数据库等实例|
|规则优先级|有规则冲突时，默认应用位置更前的规则|有规则冲突时，默认应用位置更前的规则|


### VPC & 安全组

防火墙主要是做南北向的访问控制，作用范围是整个VPC，安全组主要是做东西向的访问控制，作用范围是虚拟机网卡，和防火墙形成互补的关系。当然，安全组也是可以做南北向的访问控制的，从安全的角度来看，在离威胁源更近的地方进行防护是更好的方式，所以南北向交给防火墙来做，安全组作为防火墙的补充，是云主机安全的最后防线。
安全组和防火墙不是两者只取其一的关系，他们是相辅相成的，两者有机结合，才能够更好的做云主机的安全防护。

{% asset_img vpc2.jpg %}


## 案例分析

{% asset_img vpc-t.png %}

核心组成部分

私有网络有三个核心组成部分：私有网络网段、子网、路由表。

私有网络网段
用户在创建私有网络时，需要用 CIDR（无类别域间路由） 作为私有网络指定 IP 地址组。

腾讯云私有网络 CIDR 支持使用如下私有网段中的任意一个：

10.0.0.0 - 10.255.255.255（掩码范围需在16 - 28之间）
172.16.0.0 - 172.31.255.255（掩码范围需在16 - 28之间）
192.168.0.0 - 192.168.255.255 （掩码范围需在16 - 28之间）
子网
一个私有网络由至少一个子网组成，私有网络中的所有云资源（如云服务器、云数据库等）都必须部署在子网内，子网的 CIDR 必须在私有网络的 CIDR 内。

私有网络具有 地域（Region） 属性（如广州），而子网具有 可用区（Zone） 属性（如广州一区），您可以为私有网络划分一个或多个子网，同一私有网络下不同子网默认内网互通，不同私有网络间（无论是否在同一地域）默认内网隔离。


路由表
用户创建私有网络时，系统会自动为其生成一个默认路由表，以保证同一个私有网络下的所有子网互通，当默认路由表中的路由策略无法满足应用时，您可以创建自定义路由表。

更多关于路由表的介绍，请参见 路由表概述。

私有网络连接

腾讯云为您提供丰富的VPC连接方案，以满足不同用户的场景需求：

通过弹性公网 IP 和 NAT 网关等，实现 VPC 内的云服务器、云数据库等资源连接公网。
通过对等连接和云联网，实现不同 VPC 间的通信。
通过 VPN 连接、专线接入和云联网，实现 VPC 与本地数据中心的互联。
更多关于私有网络连接的介绍，请参见 VPC 连接方案概述。

私有网络安全

私有网络为云上逻辑隔离的网络空间，不同私有网络间相互隔离，保障您的业务安全：

安全组：安全组是一种有状态的包过滤虚拟防火墙，用于控制实例级别的出入流量，是重要的网络安全隔离手段。
网络 ACL：网络 ACL 是一个子网级别的、无状态的包过滤虚拟防火墙，用于控制进出子网的数据流，可以精确到协议和端口粒度。
访问管理（CAM）：访问管理提供用户安全管理腾讯云账户下所有资源的访问权限。通过访问管理，您可以对私有网络的访问进行权限管理，例如，通过身份管理和策略管理控制用户访问私有网络的权限。


{% asset_img vpc.png %}

---

## 参考文献

- [华为云的网络规划介绍](https://support.huaweicloud.com/eu-west-0-usermanual-vpc/vpc_0001.html)