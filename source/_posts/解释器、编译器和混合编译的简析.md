---
title: 解释器、编译器和混合编译的简析
date: 2021-10-26 12:05:39
tags:
---

## 名词解释

- 源代码：Source Code，
- 机器码：Machine Code，
- 字节码：ByteCode
- 解释器：Interpreter
- 编译器：Compiler
- 运行时：Runtime
- 虚拟机：Virtual Machine

### Source code - 源代码

是指一系列人类可读的计算机语言指令，最常用的格式是文本文件。

### Object code - 目标代码

是编译器或汇编器处理源代码后所生成的代码，一般包含着机器码以及代码在运行时使用的数据，如重定位信息、用于链接或调试的程序符号、调试信息等。目标文件是从源代码文件产生程序文件这一过程的中间产物，链接器（Linker）通过把目标文件链接在一起来生成可执行文件或库文件。

### Machine code - 机器码

是用二进制代码表示的、计算机能直接识别和执行的一种机器指令的集合。有时也被称为原生码（Native Code）。

### Bytecode - 字节码

通常指的是已经经过编译，但与特定机器代码无关，需要解释器转译后才能成为机器代码的中间代码。字节码通常不像源码一样可以让人阅读，主要为了实现特定软件运行和软件环境、与硬件环境无关。字节码的实现方式是通过编译器和虚拟机。编译器将源码编译成字节码，特定平台上的虚拟机将字节码转译为可以直接运行的指令。字节码的典型应用为Java bytecode。

二进制格式.机器语言（machine language）是一种指令集的体系。这种指令集称为机器代码（machine code），是计算机的CPU可直接解读的资料。

一汇编程序被用于转换汇编代码转换为机器代码（目标代码）。链接器链接多个对象（和库）文件以生成可执行文件。汇编器还可以直接汇编为机器代码可执行文件，而无需对象中间步骤。

### Virtual Machine - 虚拟机

指通过软件模拟的具有完整硬件系统功能的、运行在一个完全隔离环境中的完整计算机系统。
在实体计算机中能够完成的工作在虚拟机中都能够实现。
在计算机中创建虚拟机时，需要将实体机的部分硬盘和内存容量作为虚拟机硬盘和内存容量。每个虚拟机都有独立的CMOS、硬盘和操作系统，可以像使用实体机一样对虚拟机进行操作。
最为程序员所知的虚拟机是linux虚拟机，一种安装在Windows上的虚拟linux操作环境，就被称为linux虚拟机。它实际上只是个文件而已，是虚拟的linux环境，而非真正意义上的操作统。但是它们的实际效果是一样的。
Java虚拟机（JVM）是Java Virtual Machine的缩写，它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能模拟来实现的。Java虚拟机有自己完善的硬件架构，如处理器、堆栈、寄存器等，还具有相应的指令系统。

### Runtime - 运行时

阿斯顿


## 传统意义的编程模式 

### 解释型语言 - Interpreted language

解释器是一种计算机程序，能够把解释型语言解释执行。解释器就像一位“中间人”。解释器边解释边执行，因此依赖于解释器的程序运行速度比较缓慢。

解释器的好处是它不需要重新编译整个程序，从而减轻了每次程序更新后编译的负担。
相对的编译器一次性将所有源代码编译成二进制文件，执行时无需依赖编译器或其他额外的程序。

以Basic，Shell为例

### 编译型语言- Compiled language

编译器是一种计算机程序，它会将某种编程语言写成的源代码（原始语言）转换成另一种编程语言（目标语言）。

它主要的目的是将便于人编写、阅读、维护的高级计算机语言所写作的源代码程序，翻译为计算机能解读、运行的低阶机器语言的程序，也就是可执行文件。编译器将原始程序（source program）作为输入，翻译产生使用目标语言（target language）的等价程序。源代码一般为高级语言（High-level language），如Pascal、C、C++、C# 、Java等，而目标语言则是汇编语言或目标机器的目标代码（Object code），有时也称作`机器码（Machine code）`。

一个现代编译器的主要工作流程如下：

`源代码（source code）`→ 预处理器（preprocessor）→ 编译器（compiler）→ 汇编程序（assembler）→ 目标代码（object code）→ 链接器（linker）→ 可执行文件（executables），最后打包好的文件就可以给电脑去判读运行了。

{% asset_img code.png %}

为了从源代码到机器语言，程序必须通过编译器进行转换。编译器产生一种称为目标代码的中间形式。目标代码通常与计算机的机器语言相同或相似。生成可执行程序的最后一步是将目标代码转换为机器语言，如果它不是这种形式的话。这可以通过许多不同类型的程序来完成，称为汇编程序、绑定程序、 链接程序和加载程序。


以C语言为例

> 汇编语言：一种更人性化的机器语言版本，称为汇编语言，使用助记符代码来指代机器代码指令，而不是直接使用指令的数值，并使用符号名称来指代存储位置，有时还指代寄存器。例如，在Zilog Z80处理器上，00000101导致 CPU 递减B 处理器寄存器的机器代码将在汇编语言中表示为DEC B。



### 对比分析

编译器和解释器的区别在于是否编译和执行过程是否是同时进行。

编译器所干的事，将一门语言 X 编译为另一门语言 Y （可以是语言 X、高级语言、低级语言等），整个编译过程涉及词法分析、语法分析、语义分析。该过程往往由程序员在编写程序时完成。

而解释器则直接将语言 X 编写的程序在目标机器上运行。CPU就可以被当作某种指令集合的解释器。事实上，CPU的指令集合可能比我们看到的更复杂，其内部由更多的私有指令集合组成，转化为可见的公有指令集合。

特点：
解释器：
优点：跨平台、启动速度快、开发效率高
缺点：执行速度慢，执行效率低
编译器：
优点：执行速度快、执行效率高
缺点：平台相关性高，编译速度（启动速度）慢，开发效率低
可以看出，二者的特点起到了一个很好的互补关系，所以没有谁好谁坏的说法，同时Java很好的融合了这两者的优点。

区别：
编译器输出一个翻译完成后的可执行文件，是一个二进制数据流；解释器输出解释后运行的结果；

|项目|编译器 - Compiler|解释器 - Interpreter|
|:-:|:-:|:-:|
|典型产品|gcc、VC|Basic，bash|
|优化目标 | 更快的运行速度 | 更少的内存占用 |
|外部存储 | 必须的 | 可选的 | 
|错误检查 | 运行前的编译阶段 | 运行过程中| 
|源代码|直接运行二进制机器码 | 运行环节必须依赖源代码|
|运行环境|操作系统提供的Runtime Library | 必须依赖于解释器|
|跨平台支持|维护不同版本的源代码，并需要编译环节|通过解释器（或虚拟机）适配不同平台，源代码无需修改|
|运行效率|安装（编译）速度慢，运行速度快|启动速度快，运行速度慢|

## 现代意义的编程模式

## 混合编译

### Java

### Python

### JavaScript

### AOT

### JIT