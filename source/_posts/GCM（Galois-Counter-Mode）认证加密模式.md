---
title: GCM（Galois/Counter Mode）认证加密模式
date: 2023-12-02 17:29:03
tags:
---

加密技术研究的核心是**机密性保护**，历史上曾经将**完整性保护**（即在某些数据被修改后的情况下密码的误差传播特性）也一并纳入设计目标，但现代的研究已经确立信息安全的“**CIA原理（Confidentiality、Integrity、Availability）**”，普遍将完整性保护作为另一个完全不同的，与加密无关的密码学目标。

## 三、认证加密模式 - Authenticated Encryption

ECB，CBC，OFB，CFB，CTR 和 XTS 模式仅仅提供了机密性；为了保证加密信息没有被意外修改或恶意篡改，需要采用分离的消息验证码，例如CBC-MAC。密码学社群认识到了对专用的保证完整性的方法的需求，NIST 因此提出了 HMAC，CMAC 和 GMAC。HMAC 在2002年通过了认证，CMAC 在2005年通过，GMAC 则在2007年被标准化。
> HMAC 基于单向散列函数实现，可以检查消息的完整性，但**无法确保来源的可靠性**
> CMAC 基于分组密码实现，基于共享密钥派生出两个中间密钥，并进行两次哈希计算得到
> GMAC 基于伽罗华域乘法等算法实现，可以看做对称加密算法和消息认证码的结合

在发现将认证模式与加密模式联合起来的难度之后，密码学社区开始研究结合了加密和认证的单一模式，这种模式被称为认证加密模式（AE，Authenticated Encryption），或称为authenc。AE模式的例子包括CCM，GCM，CWC，EAX，IAPM 和 OCB。

### 1. GCM (Galois Counter Mode，分组模式）

![GCM](GCM.png)

GCM (Galois/Counter) 模式在 CTR 模式的基础上，添加了消息认证的功能，而且同时还具有与 CTR 模式相同的并行计算能力。因此相比 CTR 模式，GCM 不仅速度一样快，还能额外提供对消息完整性、真实性的验证能力。

在密码学中，伽罗瓦/计数器模式( GCM ) 是对称密钥加密分组密码的一种操作模式，因其性能而被广泛采用。可以使用廉价的硬件资源实现最先进的高速通信通道的 GCM 吞吐率。 [1]该操作是一种经过身份验证的加密算法，旨在提供数据真实性（完整性）和保密性。 GCM 是为块大小为 128 位的块密码定义的。 伽罗瓦消息认证码（Galois Message Authentication Code ，GMAC ) 是 GCM 的仅认证变体，可以形成增量消息认证代码。 GCM 和 GMAC 都可以接受任意长度的初始化向量。

不同的分组密码操作模式可能具有明显不同的性能和效率特性，即使使用相同的分组密码也是如此。 GCM 可以充分利用并行处理，实现 GCM 可以有效利用指令流水线或硬件流水线。相比之下，密码块链接（CBC）操作模式会导致流水线停顿，从而影响其效率和性能。

与普通计数器模式一样，块按顺序编号，然后该块编号与初始化向量（Initialization Vector，IV） 组合并使用块密码E加密，通常为AES 。然后将此加密的结果与明文进行异或以产生密文。与所有计数器模式一样，这本质上是一个流密码，因此对于每个加密的流使用不同的 IV 是必不可少的。

密文块被视为多项式的系数，然后在依赖于密钥的点H使用有限域算术对其进行评估。然后对结果进行加密，生成可用于验证数据完整性的身份验证标签。然后，加密文本包含 IV、密文和身份验证标签。
